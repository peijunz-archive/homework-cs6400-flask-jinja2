{% extends "base.html" %}

{% block title %}Search Results{% endblock %}

{% block content %}
<div class="card form-card">
    <div class="card-header">
        <h3 class="panel-title">Search Results</h3>
    </div>
    <div class="card-body">
        <h4>
        {% if incident %}
            Results for <span class="incidentName text-primary">{{ incident }}</span>
        {% else %}
            All Resources
        {% endif %}
        </h4>
        <table class="table table-striped">
            <thead>
            <tr>
                <th scope="col">ID</th>
                <th scope="col">Name</th>
                <th scope="col">Owner</th>
                <th scope="col">Cost</th>
                <th scope="col">Status</th>
                <th scope="col">Next Available</th>
                {% if incident %}
                <th scope="col">Distance</th>
                <th scope="col">Action</th>
                {% endif %}
            </tr>
            </thead>
            <tbody>
            {% for it in resources %}
            <tr>
                <td scope="row">{{ it.ID }}</td>
                <td>{{ it.Name }}</td>
                <td>{{ it.Owner }}</td>
                <td>{{ "$%.2f/%s" %(it.Cost, it.UnitName) }}</td>
                <td>{% if it.ReturnDate %}NOT Available{% else %}Available{% endif %}</td>
                <td>
                {% if it.ReturnDate %}
                    {{it.ReturnDate.strftime('%Y-%m-%d')}}
                {% else %}
                    NOW
                {% endif %}
                </td>
                {% if incident %}
                <td>{{ "%.2f" % it.proximity }}</td>
                <td>
                {% if it.Own and it.ReturnDate %}
                    Deployed
                {% else %}
                    <button type="button" class="btn btn-secondary" data-toggle="modal" data-target="#requestModal" data-id="{{ it.ID }}">
                    {% if it.Own %}
                    Deploy
                    {% else %}
                    Request
                    {% endif %}
                    </button>
                {% endif %}
                </td>
                {% endif %}
            </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}

{% block modal %}
{% include 'return-date.html' %}
{% endblock %}
